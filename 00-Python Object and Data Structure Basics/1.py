from datetime import datetime, timedelta
from pytz import timezone,utc
from pyspark.sql.types import StructField, StructType, ArrayType, LongType, StringType, BooleanType, TimestampType, \
    IntegerType, DoubleType,DateType,Row


now = datetime.now()
date_format='%Y-%m-%d %H:%M:%S.%f'
pst_date = datetime.now(tz=utc).astimezone(timezone('US/Pacific')).strftime(date_format)
v_date = datetime.strptime(pst_date,date_format).date()

def list_analysis():
    # List are Mutable
    #List items are ordered, changeable, and allow duplicate values.
    #When we say that lists are ordered, it means that the items have a defined order, and that order will not change.
    #The list is changeable, meaning that we can change, add, and remove items in a list after it has been created.



    l1 = [1,2,"abc",3,3.0]
    print(l1[1])
    l2=['a', ['bb', 'cc'], 'd']
    print(l2[1])
    print(l2[1][0])
    l2.append("f")
    print(l2)
    l2.append(["gg","hh"])
    print(l2)
    l2[1].insert(0,"bc")
    print(l2)
    l3=[(1,2),(3,4),(5,6)]
    print(l2[3])
    l3.append("7")
    print(l3)
    l3.append((8,9))
    print(l3)
    l4=[1,4,2,5,3,9,8]
    l4.sort()
    print(l4)

def dict_analysis():
    d1 = {1:"apple",2:"orange"}
    print(d1.items())
    d2={"itp-aia-datalake.cortex_cs_works.xdr_adoption_rate":"snapshotdate"
        ,"itp-aia-datalake.cortex_cs_works.xsoar_adoption_rate":"snapshotdate"
        ,"itp-aia-datalake.cortex_cs_works.xdr_deployment_rate": "snapshotdate"
        }
    print(d2)
    v_sql=''
    for k,v in d2.items():
        v_sql += f" UNION ALL SELECT MAX({v}) AS snapshot_date,'{k.split('.')[2]}' as table_name FROM {k}"
        print(v_sql)
    print("update sql")
    v_sql = f"{v_sql[11:]}"
    print(v_sql)
    v_sql = f"SELECT * FROM ({v_sql}) WHERE date(snapshot_date)!='{v_date}'"
    print(v_sql)

def convert_listof_dict():
    l1=[{'name': 'insights', 'type': 'INTEGER'}, {'name': 'changestatus', 'type': 'STRING'}, {'name': 'isdebug', 'type': 'BOOLEAN'}, {'name': 'feedbased', 'type': 'BOOLEAN'}, {'name': 'linkedcount', 'type': 'INTEGER'}, {'mode': 'REPEATED', 'name': 'linkedincidents', 'type': 'INTEGER'}, {'name': 'parent', 'type': 'STRING'}, {'name': 'notifytime', 'type': 'TIMESTAMP'}, {'name': 'rawclosereason', 'type': 'STRING'}, {'name': 'openduration', 'type': 'INTEGER'}, {'name': 'attachment', 'type': 'STRING'}, {'fields': [{'name': 'type', 'type': 'STRING'}, {'name': 'value', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'labels', 'type': 'RECORD'}, {'name': 'closed', 'type': 'TIMESTAMP'}, {'name': 'reason', 'type': 'STRING'}, {'name': 'rawname', 'type': 'STRING'}, {'name': 'rawtype', 'type': 'STRING'}, {'name': 'autime', 'type': 'INTEGER'}, {'name': 'account', 'type': 'STRING'}, {'name': 'cacheversn', 'type': 'INTEGER'}, {'name': 'version', 'type': 'INTEGER'}, {'name': 'xsoarreadonlyroles', 'type': 'STRING'}, {'name': 'vulcanmode', 'type': 'STRING'}, {'name': 'vulcanstatus', 'type': 'STRING'}, {'name': 'tmp', 'type': 'INTEGER'}, {'mode': 'REPEATED', 'name': 'test', 'type': 'STRING'}, {'name': 'sourcebrand', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'similarincidents', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'regionsmarketing', 'type': 'STRING'}, {'name': 'phase', 'type': 'STRING'}, {'name': 'heaptarget', 'type': 'STRING'}, {'name': 'dbotstatus', 'type': 'STRING'}, {'name': 'dbotmirrorlastsync', 'type': 'TIMESTAMP'}, {'name': 'dbotmirrorinstance', 'type': 'STRING'}, {'name': 'dbotmirrordirection', 'type': 'STRING'}, {'name': 'dbotduedate', 'type': 'TIMESTAMP'}, {'name': 'dbotcreatedby', 'type': 'STRING'}, {'name': 'closinguserid', 'type': 'STRING'}, {'name': 'lastopen', 'type': 'TIMESTAMP'}, {'name': 'closereason', 'type': 'STRING'}, {'name': 'xpanseframeworkphase', 'type': 'STRING'}, {'name': 'dbottotaltime', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'xsoarbotunsubscribedusers', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'xsoarbotreporttable', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'xsiambotemailcommunication', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdruseremail', 'type': 'RECORD'}, {'name': 'xdrupgradecomments', 'type': 'STRING'}, {'name': 'xdrtotalstorededr', 'type': 'FLOAT'}, {'name': 'xdrtbusagedaily', 'type': 'FLOAT'}, {'name': 'xdrtblicensecount', 'type': 'INTEGER'}, {'name': 'xdrproupgrade', 'type': 'BOOLEAN'}, {'name': 'investigationid', 'type': 'INTEGER'}, {'name': 'xdrsalesrep', 'type': 'STRING'}, {'name': 'xdrpronextrenewalq', 'type': 'STRING'}, {'name': 'xdrprolastrenewalq', 'type': 'STRING'}, {'name': 'xdrprocustomerrenewalamt', 'type': 'FLOAT'}, {'name': 'xdrpreventrenewaldate', 'type': 'TIMESTAMP'}, {'name': 'xdrpreventlastrenewalq', 'type': 'STRING'}, {'name': 'xdrpreventfttv', 'type': 'INTEGER'}, {'name': 'xdrprocustomersince', 'type': 'TIMESTAMP'}, {'name': 'xdrpreventcustomersinceq', 'type': 'STRING'}, {'name': 'xdrpreventcustomerproductiongolivedate', 'type': 'TIMESTAMP'}, {'name': 'xdrprorenewaldate', 'type': 'TIMESTAMP'}, {'name': 'xdrofficehourslasteventdate', 'type': 'TIMESTAMP'}, {'name': 'xdrmthlicensestatus', 'type': 'BYTES'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdrincidentstatus', 'type': 'RECORD'}, {'mode': 'REPEATED', 'name': 'xdrid', 'type': 'INTEGER'}, {'name': 'xdrirsn', 'type': 'STRING'}, {'name': 'zombie', 'type': 'BOOLEAN'}, {'name': 'xdrhealthstatus', 'type': 'STRING'}, {'name': 'xdrgbusage', 'type': 'FLOAT'}, {'name': 'xdrgblicensecount', 'type': 'INTEGER'}, {'name': 'xdrfrontendversion', 'type': 'STRING'}, {'name': 'xdrprocustomerproductiongolivedate', 'type': 'TIMESTAMP'}, {'name': 'xdrkomeventdate', 'type': 'TIMESTAMP'}, {'name': 'xdrforensicstenant', 'type': 'BOOLEAN'}, {'name': 'xdrexceptionblacklist', 'type': 'INTEGER'}, {'name': 'xdreolagentcountin180days', 'type': 'INTEGER'}, {'name': 'closenotes', 'type': 'STRING'}, {'name': 'xdreolagentcount', 'type': 'INTEGER'}, {'name': 'xdredrlicensecount', 'type': 'INTEGER'}, {'name': 'xdrdatausage24hours', 'type': 'INTEGER'}, {'mode': 'REPEATED', 'name': 'xsiambotunsubscribedusers', 'type': 'STRING'}, {'name': 'xdrcurrentconnectededragents', 'type': 'INTEGER'}, {'name': 'xdrcurrentconnectedagents', 'type': 'INTEGER'}, {'name': 'occurred', 'type': 'TIMESTAMP'}, {'name': 'xdrcloudedrlicensecount', 'type': 'INTEGER'}, {'name': 'xdrcloudedragentcount', 'type': 'INTEGER'}, {'name': 'xdrtenantid', 'type': 'STRING'}, {'name': 'xdrcloudagentlicensecount', 'type': 'INTEGER'}, {'name': 'xdrcloudagentedrlicensecount', 'type': 'INTEGER'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdrbrokervmversion', 'type': 'RECORD'}, {'fields': [{'name': 'sent', 'type': 'BOOLEAN'}, {'name': 'action', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrbotsent', 'type': 'RECORD'}, {'name': 'status', 'type': 'INTEGER'}, {'name': 'xdrexceptionwhitelist', 'type': 'INTEGER'}, {'fields': [{'mode': 'REPEATED', 'name': 'contacts', 'type': 'STRING'}, {'name': 'lcaasid', 'type': 'INTEGER'}, {'name': 'date', 'type': 'STRING'}, {'name': 'action', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrbotemailcommunication', 'type': 'RECORD'}, {'mode': 'REPEATED', 'name': 'regionstestaccount', 'type': 'STRING'}, {'name': 'xdranalyticssn', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdragentscontentversion', 'type': 'RECORD'}, {'name': 'xdrupgradebatch', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdragentversioncount', 'type': 'RECORD'}, {'name': 'xdradoptionrate', 'type': 'FLOAT'}, {'name': 'xsoarapikey', 'type': 'STRING'}, {'name': 'xdractiveusers', 'type': 'INTEGER'}, {'name': 'xdrtenantdistributionlist', 'type': 'STRING'}, {'name': 'xdrmthlicense', 'type': 'BOOLEAN'}, {'name': 'xdractivated', 'type': 'BOOLEAN'}, {'name': 'whichversionareyouon', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'whichotherpanwproductsdoyouhave', 'type': 'STRING'}, {'name': 'xdrpreventnextrenewalq', 'type': 'STRING'}, {'name': 'whichtipproductareyouusingandareyouhappywithit', 'type': 'STRING'}, {'name': 'wheredoyouplantobeintheupcomingyear', 'type': 'STRING'}, {'name': 'wheredoyoudevelopcontent', 'type': 'STRING'}, {'name': 'whatpercentageofthosealertsareyouactivelyreviewing', 'type': 'STRING'}, {'name': 'welcomeemailexclusionreason', 'type': 'STRING'}, {'fields': [{'name': 'tbusage', 'type': 'FLOAT'}, {'name': 'vendor', 'type': 'STRING'}, {'name': 'lcaasid', 'type': 'INTEGER'}, {'name': 'product', 'type': 'STRING'}, {'name': 'gbusage', 'type': 'FLOAT'}], 'mode': 'REPEATED', 'name': 'xdrdatasources', 'type': 'RECORD'}, {'name': 'watchedlchowtovideos', 'type': 'BOOLEAN'}, {'name': 'valueof3rdpartyfwlogingestion', 'type': 'STRING'}, {'fields': [{'name': 'totalconnections', 'type': 'INTEGER'}, {'name': 'os_version', 'type': 'STRING'}, {'name': 'version', 'type': 'STRING'}, {'name': 'lcaas_id', 'type': 'INTEGER'}, {'name': 'autoupgrade', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'applets', 'type': 'STRING'}, {'name': 'hypervisor', 'type': 'STRING'}, {'name': 'deviceid', 'type': 'STRING'}, {'name': 'agentservicestatus', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrbrokervm', 'type': 'RECORD'}, {'name': 'usageasofdate', 'type': 'TIMESTAMP'}, {'name': 'activated', 'type': 'TIMESTAMP'}, {'name': 'uattenant', 'type': 'BOOLEAN'}, {'name': 'duedate', 'type': 'TIMESTAMP'}, {'name': 'trapssn', 'type': 'STRING'}, {'name': 'ticketsubject', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'regionsprodhosted', 'type': 'STRING'}, {'name': 'formcompletedby', 'type': 'STRING'}, {'name': 'ticketopeneddate', 'type': 'TIMESTAMP'}, {'name': 'ticketdescription', 'type': 'STRING'}, {'name': 'canvases', 'type': 'STRING'}, {'name': 'ticketcloseddate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'tenantid', 'type': 'STRING'}, {'name': 'tenantactivationdate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'telemetryxpansecsmetrics', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'telemetry', 'type': 'STRING'}, {'name': 'technicalreviewcompletiondate', 'type': 'TIMESTAMP'}, {'fields': [{'name': 'taskname', 'type': 'STRING'}, {'name': 'taskdescription', 'type': 'STRING'}, {'name': 'duedate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'comments', 'type': 'STRING'}, {'name': 'done', 'type': 'BOOLEAN'}], 'mode': 'REPEATED', 'name': 'tasklist', 'type': 'RECORD'}, {'name': 'timlicense', 'type': 'STRING'}, {'name': 'droppedcount', 'type': 'INTEGER'}, {'name': 'xsoarbotreportsuccess', 'type': 'STRING'}, {'name': 'successlevelcomments', 'type': 'STRING'}, {'name': 'successlevel', 'type': 'STRING'}, {'name': 'subcategory', 'type': 'STRING'}, {'name': 'state', 'type': 'STRING'}, {'name': 'vulcanregion', 'type': 'STRING'}, {'name': 'technicalreviewcompleted', 'type': 'BOOLEAN'}, {'name': 'sourceport', 'type': 'STRING'}, {'name': 'smartsheetlinkifapplicable', 'type': 'STRING'}, {'name': 'signatureprogram', 'type': 'BOOLEAN'}, {'name': 'name', 'type': 'STRING'}, {'name': 'sendannualhealthcheckmail', 'type': 'BOOLEAN'}, {'name': 'salesvp', 'type': 'STRING'}, {'fields': [{'name': 'salesupdate', 'type': 'STRING'}, {'name': 'salesfollowupdate', 'type': 'TIMESTAMP'}], 'mode': 'REPEATED', 'name': 'salesupdates', 'type': 'RECORD'}, {'fields': [{'name': 'salesupdate', 'type': 'STRING'}, {'name': 'escalated', 'type': 'BOOLEAN'}, {'name': 'salesrequestcompleteflag', 'type': 'BOOLEAN'}, {'name': 'salesrequestcompletedate', 'type': 'TIMESTAMP'}, {'name': 'requestforsalesdate', 'type': 'TIMESTAMP'}, {'name': 'requestforsales', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'salesupdate', 'type': 'RECORD'}, {'name': 'saleshandovernotes', 'type': 'STRING'}, {'name': 'sqsbody', 'type': 'STRING'}, {'fields': [{'name': 'tenantid', 'type': 'INTEGER'}, {'name': 'activehostscount', 'type': 'INTEGER'}, {'name': 'status', 'type': 'STRING'}, {'name': 'region', 'type': 'STRING'}, {'name': 'analytics', 'type': 'STRING'}, {'name': 'gcp_region', 'type': 'STRING'}, {'name': 'lcaas_id', 'type': 'INTEGER'}, {'name': 'fqdn', 'type': 'STRING'}, {'name': 'deleted', 'type': 'BOOLEAN'}, {'name': 'cspname', 'type': 'STRING'}, {'name': 'licensetype', 'type': 'STRING'}, {'name': 'expirationdate', 'type': 'STRING'}, {'name': 'creationdate', 'type': 'STRING'}, {'name': 'analytics_enabled', 'type': 'INTEGER'}, {'name': 'cspid', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdrtenants', 'type': 'RECORD'}, {'name': 'socdetails', 'type': 'STRING'}, {'name': 'sha512', 'type': 'STRING'}, {'name': 'sha256', 'type': 'STRING'}, {'name': 'sfdcstatus', 'type': 'STRING'}, {'name': 'sfdcrequestpriority', 'type': 'STRING'}, {'name': 'sfdcpriority', 'type': 'STRING'}, {'name': 'sfdcopptylink', 'type': 'STRING'}, {'name': 'sfdcopportunitysubspecialization', 'type': 'STRING'}, {'name': 'sfdcopportunitystage', 'type': 'STRING'}, {'name': 'sfdcopportunityownername', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'dbotmirrortags', 'type': 'STRING'}, {'name': 'xdrsku', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'sfdcopportunityids', 'type': 'STRING'}, {'name': 'sfdclastcommentdate', 'type': 'TIMESTAMP'}, {'name': 'sfdcentitlementaccountid', 'type': 'STRING'}, {'name': 'rawcategory', 'type': 'STRING'}, {'name': 'sfdccasetaxonomytype', 'type': 'STRING'}, {'name': 'sfdccasetaxonomytechnology', 'type': 'STRING'}, {'name': 'xdrlegacylicense', 'type': 'BOOLEAN'}, {'name': 'sfdccasetaxonomysmearea', 'type': 'STRING'}, {'name': 'sfdccasetaxonomyproductproblemarea', 'type': 'STRING'}, {'name': 'soc', 'type': 'BOOLEAN'}, {'name': 'sfdccasetaxonomyissuecontext', 'type': 'STRING'}, {'name': 'salesoutreachdate', 'type': 'TIMESTAMP'}, {'name': 'sfdccasetaxonomycasereason', 'type': 'STRING'}, {'name': 'sfdccasestatustype', 'type': 'STRING'}, {'name': 'sfdccaseid', 'type': 'STRING'}, {'name': 'sfdccapstatus', 'type': 'BOOLEAN'}, {'name': 'sfdcaccountownername', 'type': 'STRING'}, {'name': 'sfdcaccountid', 'type': 'STRING'}, {'name': 'sansstage', 'type': 'STRING'}, {'name': 'riskiqassetawssecuritygroupname', 'type': 'STRING'}, {'name': 'xdrprofttv', 'type': 'INTEGER'}, {'name': 'retentionrisksubcategory', 'type': 'STRING'}, {'name': 'xdrlastlogintime', 'type': 'TIMESTAMP'}, {'name': 'retentionriskcategory', 'type': 'STRING'}, {'name': 'ticketacknowledgeddate', 'type': 'TIMESTAMP'}, {'name': 'retentionrisk', 'type': 'STRING'}, {'name': 'dbotmodified', 'type': 'TIMESTAMP'}, {'name': 'requestaction', 'type': 'STRING'}, {'name': 'selectcustomer', 'type': 'STRING'}, {'name': 'renewalstatus', 'type': 'STRING'}, {'name': 'haveyouinvitedthemtojointhecommunityaccessedition', 'type': 'STRING'}, {'name': 'referenceupdates', 'type': 'STRING'}, {'name': 'referencetype', 'type': 'STRING'}, {'name': 'quickstartdone', 'type': 'BOOLEAN'}, {'name': 'ticketurl', 'type': 'STRING'}, {'name': 'question6productrecommendation', 'type': 'STRING'}, {'name': 'question4staffkindness', 'type': 'STRING'}, {'name': 'attendedxdrwebinars', 'type': 'STRING'}, {'name': 'ptexceptionreason', 'type': 'STRING'}, {'name': 'question1answer', 'type': 'STRING'}, {'name': 'salesdsm', 'type': 'STRING'}, {'name': 'question1psscope', 'type': 'STRING'}, {'name': 'question0answer', 'type': 'STRING'}, {'name': 'protocol', 'type': 'STRING'}, {'name': 'inproductionneedcs', 'type': 'BOOLEAN'}, {'name': 'productiondelayreasoncategory', 'type': 'STRING'}, {'name': 'prodxdrsku', 'type': 'STRING'}, {'name': 'prodxdrregion', 'type': 'STRING'}, {'name': 'prodtrapssku', 'type': 'STRING'}, {'name': 'sourcenetwork', 'type': 'STRING'}, {'name': 'prodtrapsregion', 'type': 'STRING'}, {'name': 'ticketnumber', 'type': 'STRING'}, {'name': 'customerindustry', 'type': 'STRING'}, {'name': 'prodmagnifertenantid', 'type': 'STRING'}, {'name': 'productfqdn', 'type': 'STRING'}, {'name': 'prodmagniferactivated', 'type': 'STRING'}, {'name': 'xdrprocustomersinceq', 'type': 'STRING'}, {'name': 'prodauthcode', 'type': 'STRING'}, {'name': 'cvedescription', 'type': 'STRING'}, {'name': 'previouscustomerinproduction', 'type': 'TIMESTAMP'}, {'name': 'xdrforensicscount', 'type': 'INTEGER'}, {'name': 'teamname', 'type': 'STRING'}, {'name': 'prodmagniferregion', 'type': 'STRING'}, {'name': 'premiumcs', 'type': 'STRING'}, {'name': 'postproductiondelaynotification', 'type': 'BOOLEAN'}, {'name': 'prodmagniferactivationdate', 'type': 'STRING'}, {'name': 'customerarr', 'type': 'FLOAT'}, {'name': 'phonenumber', 'type': 'STRING'}, {'name': 'customerexeccontactname', 'type': 'STRING'}, {'name': 'customersuccessengineer', 'type': 'STRING'}, {'name': 'performquarterlyoperationalreviews', 'type': 'BOOLEAN'}, {'name': 'panoramasn', 'type': 'STRING'}, {'name': 'xdrsalesengineer', 'type': 'STRING'}, {'name': 'pttransition', 'type': 'BOOLEAN'}, {'name': 'pstypeconsulting', 'type': 'STRING'}, {'name': 'riskiqassetgcpfirewallname', 'type': 'STRING'}, {'name': 'psquickstartengaged', 'type': 'BOOLEAN'}, {'fields': [{'name': 'total', 'type': 'INTEGER'}, {'name': 'cve', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'agentversion', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'cortexxdragentaffectedcves', 'type': 'RECORD'}, {'name': 'nclbstatus', 'type': 'STRING'}, {'name': 'psprojectmanager', 'type': 'STRING'}, {'name': 'psconsultant', 'type': 'STRING'}, {'name': 'ingestionof3rdpartydata', 'type': 'BOOLEAN'}, {'name': 'pocdone', 'type': 'BOOLEAN'}, {'name': 'isplayground', 'type': 'BOOLEAN'}, {'name': 'averageincidentsperassignee', 'type': 'FLOAT'}, {'name': 'outgoingmirrorerror', 'type': 'STRING'}, {'name': 'xdrupgradebatch2', 'type': 'BOOLEAN'}, {'name': 'optoutcustomer', 'type': 'BOOLEAN'}, {'name': 'incomingmirrorerror', 'type': 'STRING'}, {'name': 'ontrackreason', 'type': 'STRING'}, {'name': 'ejmanagementtask', 'type': 'STRING'}, {'name': 'osversion', 'type': 'STRING'}, {'name': 'xdreppagentcount', 'type': 'INTEGER'}, {'name': 'sendmailtomssponly', 'type': 'BOOLEAN'}, {'name': 'customersuccessengineername', 'type': 'STRING'}, {'name': 'os', 'type': 'STRING'}, {'name': 'ejtask', 'type': 'STRING'}, {'name': 'nointentreason', 'type': 'STRING'}, {'name': 'nclbsalescallscheduled', 'type': 'STRING'}, {'name': 'nextrenewalq', 'type': 'STRING'}, {'name': 'proddatacenter', 'type': 'STRING'}, {'name': 'newcustomername', 'type': 'STRING'}, {'name': 'needpttransition', 'type': 'BOOLEAN'}, {'name': 'question2answer', 'type': 'STRING'}, {'name': 'runstatus', 'type': 'STRING'}, {'name': 'se', 'type': 'STRING'}, {'name': 'customerreachoutapprovednotes', 'type': 'STRING'}, {'name': 'niststage', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'xdralertsourceseverity', 'type': 'STRING'}, {'name': 'ngfwdetails', 'type': 'STRING'}, {'name': 'nclbfollowupsent', 'type': 'BOOLEAN'}, {'name': 'nclbsalesrep', 'type': 'STRING'}, {'name': 'lastjobruntime', 'type': 'TIMESTAMP'}, {'name': 'pathfinder', 'type': 'BOOLEAN'}, {'name': 'nclbonholdreason', 'type': 'STRING'}, {'name': 'psincluded', 'type': 'BOOLEAN'}, {'name': 'nclbnointentreason', 'type': 'STRING'}, {'name': 'xsoarbotreportsuccesslastrun', 'type': 'STRING'}, {'name': 'nclbimplementationassistancenotes', 'type': 'STRING'}, {'name': 'nclbdeniedcustomerreachoutreason', 'type': 'STRING'}, {'name': 'sfdccasetaxonomyissueconcentration', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'firewallvendor', 'type': 'STRING'}, {'name': 'nclbcustomerreachoutnotes', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'customerintegration', 'type': 'STRING'}, {'name': 'nclbcustomerreachoutdate', 'type': 'TIMESTAMP'}, {'name': 'reminder', 'type': 'TIMESTAMP'}, {'name': 'errorlist', 'type': 'STRING'}, {'name': 'firstname', 'type': 'STRING'}, {'name': 'gainsightid', 'type': 'STRING'}, {'fields': [{'name': 'oldvalue', 'type': 'STRING'}, {'name': 'newvalue', 'type': 'STRING'}, {'name': 'modifieddate', 'type': 'TIMESTAMP'}, {'name': 'fieldname', 'type': 'STRING'}, {'name': 'editedby', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'metricsaudit', 'type': 'RECORD'}, {'name': 'vulcancid', 'type': 'STRING'}, {'name': 'medianotification', 'type': 'STRING'}, {'name': 'playbookid', 'type': 'STRING'}, {'name': 'magniferdeal', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'machines', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'dbotdirtyfields', 'type': 'STRING'}, {'name': 'sfdcopportunityid', 'type': 'STRING'}, {'name': 'accountterritoryname', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'products', 'type': 'STRING'}, {'name': 'servicenowtablename', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'cortexpstypes', 'type': 'STRING'}, {'fields': [{'name': 'default', 'type': 'BOOLEAN'}, {'name': 'cconsupport', 'type': 'BOOLEAN'}, {'name': 'phone', 'type': 'STRING'}, {'name': 'superuser', 'type': 'BOOLEAN'}, {'name': 'name', 'type': 'STRING'}, {'name': 'position', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'email', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'msspcontacts', 'type': 'RECORD'}, {'name': 'logsource', 'type': 'STRING'}, {'name': 'licensevalidtill', 'type': 'STRING'}, {'name': 'licenseuserscount', 'type': 'INTEGER'}, {'fields': [{'mode': 'REPEATED', 'name': 'contacts', 'type': 'STRING'}, {'name': 'date', 'type': 'DATE'}, {'name': 'action', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xpansebotemailcommunication', 'type': 'RECORD'}, {'name': 'deploymentphase', 'type': 'STRING'}, {'name': 'licenseusagerate', 'type': 'FLOAT'}, {'name': 'cortexsalesengineer', 'type': 'STRING'}, {'name': 'licenseexpiration', 'type': 'TIMESTAMP'}, {'name': 'licenseentryid', 'type': 'STRING'}, {'name': 'lastupdatenotedate', 'type': 'TIMESTAMP'}, {'name': 'sfdcauthorizedpaloaltonetworksreseller', 'type': 'STRING'}, {'name': 'prodmagniferdaystoexpire', 'type': 'STRING'}, {'name': 'howmanyalertsareyoureceivingtodaydailyweeklymonthly', 'type': 'STRING'}, {'name': 'novalicensexsoar', 'type': 'STRING'}, {'name': 'lastrenewalq', 'type': 'STRING'}, {'name': 'productiondelayreason', 'type': 'STRING'}, {'name': 'lastebrdate', 'type': 'TIMESTAMP'}, {'name': 'lcdiscussions', 'type': 'BOOLEAN'}, {'name': 'customerse', 'type': 'STRING'}, {'name': 'cortexdatalakesn', 'type': 'STRING'}, {'name': 'incidentsresolvedduplicate', 'type': 'INTEGER'}, {'name': 'keyopportunitiesinitiativeschallenges', 'type': 'STRING'}, {'name': 'komdate', 'type': 'TIMESTAMP'}, {'name': 'xdrbotfirstemailsent', 'type': 'TIMESTAMP'}, {'name': 'customerreachoutstatus', 'type': 'STRING'}, {'name': 'isthecustomeracurrentmthtarget', 'type': 'BOOLEAN'}, {'name': 'prodlakeregion', 'type': 'STRING'}, {'name': 'novalicensetype', 'type': 'STRING'}, {'name': 'inviteusecase', 'type': 'STRING'}, {'name': 'incidentsresolvedthreathandled', 'type': 'INTEGER'}, {'name': 'incidentsunassigned', 'type': 'INTEGER'}, {'name': 'xdrwebinarlasteventdate', 'type': 'TIMESTAMP'}, {'name': 'numberofterabytesused', 'type': 'FLOAT'}, {'name': 'incidentstotal', 'type': 'INTEGER'}, {'name': 'nclbinproductionneedcs', 'type': 'BOOLEAN'}, {'name': 'incidentsresolvedfalsepositive', 'type': 'INTEGER'}, {'name': 'sfdcrequestcategory', 'type': 'STRING'}, {'name': 'nclbonholdreasoncategory', 'type': 'STRING'}, {'name': 'ifnothenwhatobstaclesarepreventingyouteamorganizationfromusingourmthcommunityaccessofferinghowcanwehelpgetyoustartedusingtheoffe', 'type': 'STRING'}, {'name': 'question5psrecommendation', 'type': 'STRING'}, {'name': 'psprojectmanageremail', 'type': 'STRING'}, {'name': 'attendedxdrofficehourscount', 'type': 'INTEGER'}, {'name': 'iamintegrationinstance', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'howisthesocbuilt', 'type': 'STRING'}, {'name': 'ifyeswhataspectsprovidevalueforyouteamorganizationpleaseshareallthedetailsyoucanwhatopportunitiesforimprovementwouldyousuggest', 'type': 'STRING'}, {'name': 'howdoyoumanageyourcustomcontentdoyouusethedevprodremoterepositoriesfeaturecicdflow', 'type': 'STRING'}, {'name': 'salesoutreachstatus', 'type': 'STRING'}, {'name': 'customerdeployed', 'type': 'BOOLEAN'}, {'name': 'hoursspentupdated', 'type': 'TIMESTAMP'}, {'name': 'hoursspentlast90days', 'type': 'FLOAT'}, {'fields': [{'name': 'tid', 'type': 'INTEGER'}, {'name': 'tenanttype', 'type': 'STRING'}, {'name': 'id', 'type': 'INTEGER'}, {'name': 'tenantid', 'type': 'INTEGER'}, {'name': 'integrations', 'type': 'STRING'}, {'name': 'creationdate', 'type': 'DATE'}, {'name': 'expirationdate', 'type': 'DATE'}, {'name': 'status', 'type': 'STRING'}, {'name': 'gcpprojectname', 'type': 'STRING'}, {'name': 'cspname', 'type': 'STRING'}, {'name': 'analytics', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'missingalertslast90days', 'type': 'RECORD'}, {'name': 'hoursspentdeployment', 'type': 'FLOAT'}, {'name': 'dbotpredictionprobability', 'type': 'INTEGER'}, {'name': 'ifnoeducationpleaseexplain', 'type': 'STRING'}, {'name': 'alertname', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'hostnames', 'type': 'STRING'}, {'name': 'hostingregulatoryneeds', 'type': 'STRING'}, {'name': 'sla', 'type': 'INTEGER'}, {'name': 'hostedinstancepassword', 'type': 'STRING'}, {'name': 'customermovedtocs', 'type': 'BOOLEAN'}, {'name': 'healthcheckcurrentlatestversion', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'dbotcurrentdirtyfields', 'type': 'STRING'}, {'name': 'customersuccessarchitect', 'type': 'STRING'}, {'name': 'exfiltratedfiles', 'type': 'STRING'}, {'name': 'healthcheckcurrentlatestbuild', 'type': 'STRING'}, {'name': 'riskiqassetoktazoneid', 'type': 'STRING'}, {'name': 'dbotprediction', 'type': 'STRING'}, {'name': 'googledrivelocation', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'region', 'type': 'STRING'}, {'name': 'lcaas_id', 'type': 'INTEGER'}, {'name': 'total', 'type': 'INTEGER'}, {'name': 'sku', 'type': 'STRING'}, {'name': 'expiration', 'type': 'TIMESTAMP'}, {'name': 'eval', 'type': 'BOOLEAN'}, {'name': 'cspname', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrlicenses', 'type': 'RECORD'}, {'name': 'pttransitioneddate', 'type': 'TIMESTAMP'}, {'name': 'hoursspentlast7days', 'type': 'FLOAT'}, {'name': 'gbcoldretentionlicense', 'type': 'INTEGER'}, {'name': 'frameworkphase', 'type': 'STRING'}, {'name': 'csassistanceneeded', 'type': 'BOOLEAN'}, {'name': 'hoursspentlast30days', 'type': 'FLOAT'}, {'name': 'followupsent', 'type': 'BOOLEAN'}, {'name': 'directorysync', 'type': 'BOOLEAN'}, {'name': 'prodxdrdaystoactivation', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'xdralertmodulecount', 'type': 'STRING'}, {'name': 'destinationnetwork', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'lcaasid', 'type': 'INTEGER'}, {'name': 'fedrampcustomer', 'type': 'BOOLEAN'}, {'name': 'owner', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'hostedstaticips', 'type': 'STRING'}, {'name': 'previousfttv', 'type': 'INTEGER'}, {'name': 'iottenantid', 'type': 'STRING'}, {'fields': [{'name': 'productiondelayreasoncategory', 'type': 'STRING'}, {'name': 'totalhours', 'type': 'FLOAT'}, {'name': 'id', 'type': 'FLOAT'}, {'name': 'productiondelayreasonnotes', 'type': 'STRING'}, {'name': 'productline', 'type': 'STRING'}, {'name': 'task', 'type': 'STRING'}, {'name': 'completionpercentage', 'type': 'INTEGER'}, {'name': 'completiondate', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'extendedjourneytracker', 'type': 'RECORD'}, {'mode': 'REPEATED', 'name': 'escalations', 'type': 'STRING'}, {'name': 'customerexeccontactemail', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'dbdatedropdown', 'type': 'STRING'}, {'name': 'extendedjourneymilestones', 'type': 'STRING'}, {'name': 'question3answer', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'emailheaders', 'type': 'STRING'}, {'name': 'installtype', 'type': 'STRING'}, {'name': 'eventtype', 'type': 'STRING'}, {'name': 'customerreachoutdate', 'type': 'TIMESTAMP'}, {'name': 'evalstatus', 'type': 'STRING'}, {'name': 'escalation', 'type': 'STRING'}, {'name': 'sfdccasereopenreasonothers', 'type': 'STRING'}, {'name': 'brokervm', 'type': 'BOOLEAN'}, {'name': 'environment', 'type': 'STRING'}, {'name': 'dnssuffix', 'type': 'STRING'}, {'name': 'assignmentgroup', 'type': 'STRING'}, {'name': 'nclbcustomerreachoutstatus', 'type': 'STRING'}, {'fields': [{'name': 'unitofmeasure', 'type': 'STRING'}, {'name': 'termunitofmeasure', 'type': 'STRING'}, {'name': 'status', 'type': 'STRING'}, {'name': 'productcode', 'type': 'STRING'}, {'name': 'sfdcaccountid', 'type': 'STRING'}, {'name': 'serialnumber', 'type': 'STRING'}, {'name': 'cspid', 'type': 'STRING'}, {'name': 'quantity', 'type': 'STRING'}, {'name': 'tenantid', 'type': 'STRING'}, {'name': 'startdate', 'type': 'TIMESTAMP'}, {'name': 'licensetype', 'type': 'STRING'}, {'name': 'term', 'type': 'STRING'}, {'name': 'istrial', 'type': 'BOOLEAN'}, {'name': 'enddate', 'type': 'TIMESTAMP'}], 'mode': 'REPEATED', 'name': 'activeentitlements', 'type': 'RECORD'}, {'fields': [{'name': 'lcaas_id', 'type': 'INTEGER'}, {'name': 'xrequestidc', 'type': 'STRING'}, {'name': 'workloadsc', 'type': 'INTEGER'}, {'name': 'type', 'type': 'STRING'}, {'name': 'transactiontypec', 'type': 'STRING'}, {'name': 'systemmodstamp', 'type': 'TIMESTAMP'}, {'name': 'slaprocessid', 'type': 'STRING'}, {'name': 'subscriptionc', 'type': 'STRING'}, {'name': 'salesorderc', 'type': 'STRING'}, {'name': 'entitlementid', 'type': 'STRING'}, {'name': 'salesorderidc', 'type': 'STRING'}, {'name': 'rno', 'type': 'INTEGER'}, {'name': 'quantityc', 'type': 'STRING'}, {'name': 'subscriptionstatusc', 'type': 'STRING'}, {'name': 'producttypec', 'type': 'STRING'}, {'name': 'productlinksc', 'type': 'STRING'}, {'name': 'productconfigurationc', 'type': 'STRING'}, {'name': 'product1c', 'type': 'STRING'}, {'name': 'recordingestiontime', 'type': 'TIMESTAMP'}, {'name': 'primaryproductc', 'type': 'BOOLEAN'}, {'name': 'provisioningerrorsc', 'type': 'STRING'}, {'name': 'platformid', 'type': 'INTEGER'}, {'name': 'parententitlementc', 'type': 'STRING'}, {'name': 'name', 'type': 'STRING'}, {'name': 'lifecyclestatusc', 'type': 'STRING'}, {'name': 'licensingfeaturesc', 'type': 'STRING'}, {'name': 'partneraccountc', 'type': 'STRING'}, {'name': 'lastvieweddate', 'type': 'STRING'}, {'name': 'clientreferencec', 'type': 'STRING'}, {'name': 'lastreferenceddate', 'type': 'STRING'}, {'name': 'lastmodifiedbyid', 'type': 'STRING'}, {'name': 'supporttypec', 'type': 'STRING'}, {'name': 'ispublishedc', 'type': 'BOOLEAN'}, {'name': 'ascc', 'type': 'STRING'}, {'name': 'iscurrentc', 'type': 'BOOLEAN'}, {'name': 'entitlementidc', 'type': 'STRING'}, {'name': 'isconvertedc', 'type': 'BOOLEAN'}, {'name': 'instanceurlc', 'type': 'STRING'}, {'name': 'id', 'type': 'STRING'}, {'name': 'family', 'type': 'STRING'}, {'name': 'isperincident', 'type': 'BOOLEAN'}, {'name': 'evalrequestc', 'type': 'STRING'}, {'name': 'iscontractcreatedc', 'type': 'BOOLEAN'}, {'name': 'sequenceidc', 'type': 'INTEGER'}, {'name': 'opportunityc', 'type': 'STRING'}, {'name': 'entitlementjsonc', 'type': 'STRING'}, {'name': 'uniqueentitlementc', 'type': 'STRING'}, {'name': 'ismigratedc', 'type': 'BOOLEAN'}, {'name': 'remainingcases', 'type': 'STRING'}, {'name': 'relatedentitlementc', 'type': 'STRING'}, {'name': 'productc', 'type': 'STRING'}, {'name': 'partnercontactc', 'type': 'STRING'}, {'name': 'createddate', 'type': 'TIMESTAMP'}, {'name': 'effectivedatec', 'type': 'DATE'}, {'name': 'sfdcaccountid', 'type': 'STRING'}, {'name': 'createdbyprofilec', 'type': 'STRING'}, {'name': 'createdbyid', 'type': 'STRING'}, {'name': 'isdeleted', 'type': 'BOOLEAN'}, {'name': 'contractlineitemid', 'type': 'STRING'}, {'name': 'unitofmeasure', 'type': 'STRING'}, {'name': 'casesperentitlement', 'type': 'STRING'}, {'name': 'lcaasserialnumber', 'type': 'INTEGER'}, {'name': 'servicecontractid', 'type': 'STRING'}, {'name': 'termunitofmeasure', 'type': 'STRING'}, {'name': 'ccorderc', 'type': 'STRING'}, {'name': 'tenantid', 'type': 'STRING'}, {'name': 'istrial', 'type': 'BOOLEAN'}, {'name': 'supportaccountname', 'type': 'STRING'}, {'name': 'businesshoursid', 'type': 'STRING'}, {'name': 'contractlinkc', 'type': 'STRING'}, {'name': 'status', 'type': 'STRING'}, {'name': 'lastmodifieddate', 'type': 'TIMESTAMP'}, {'name': 'enddate', 'type': 'TIMESTAMP'}, {'name': 'productcode', 'type': 'STRING'}, {'name': 'assetid', 'type': 'STRING'}, {'name': 'startdate', 'type': 'TIMESTAMP'}, {'name': 'licensetype', 'type': 'STRING'}, {'name': 'serialnumber', 'type': 'STRING'}, {'name': 'ccsubscriptionc', 'type': 'STRING'}, {'name': 'quantity', 'type': 'STRING'}, {'name': 'entitlementgroupidc', 'type': 'STRING'}, {'name': 'cspid', 'type': 'STRING'}, {'name': 'channelplatformc', 'type': 'STRING'}, {'name': 'lcaasid', 'type': 'STRING'}, {'name': 'term', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'entitlements', 'type': 'RECORD'}, {'name': 'ephotretentionlicense', 'type': 'INTEGER'}, {'name': 'sourceinstance', 'type': 'STRING'}, {'name': 'entitlementstartdate', 'type': 'TIMESTAMP'}, {'name': 'customereducationaround3rdpartyfwingestion', 'type': 'BOOLEAN'}, {'name': 'prodtrapstenantid', 'type': 'STRING'}, {'name': 'engagedwithlc', 'type': 'BOOLEAN'}, {'name': 'soarlicense', 'type': 'STRING'}, {'name': 'emailto', 'type': 'STRING'}, {'name': 'customercomplexity', 'type': 'INTEGER'}, {'name': 'evaltype', 'type': 'STRING'}, {'name': 'statusdescription', 'type': 'STRING'}, {'name': 'emailtemplatelist', 'type': 'STRING'}, {'name': 'earlyadopterseaprogram', 'type': 'BOOLEAN'}, {'name': 'nclbv2statusdate', 'type': 'TIMESTAMP'}, {'name': 'ejcompletiondate', 'type': 'TIMESTAMP'}, {'name': 'customercadence', 'type': 'STRING'}, {'name': 'ejtechnicaltask', 'type': 'STRING'}, {'name': 'customermaincscontactemail', 'type': 'STRING'}, {'name': 'gbhotretentionlicense', 'type': 'INTEGER'}, {'name': 'deviceid', 'type': 'BYTES'}, {'name': 'csassistancenotes', 'type': 'STRING'}, {'name': 'instanceprofilename', 'type': 'STRING'}, {'name': 'deviceexternalip', 'type': 'STRING'}, {'name': 'iotlicensetype', 'type': 'STRING'}, {'name': 'accountcsmsdlemailaddress', 'type': 'STRING'}, {'name': 'devorprod', 'type': 'STRING'}, {'name': 'details', 'type': 'STRING'}, {'name': 'supportlevel', 'type': 'STRING'}, {'name': 'nclbstatusdate', 'type': 'TIMESTAMP'}, {'name': 'lastname', 'type': 'STRING'}, {'name': 'nclbv2status', 'type': 'STRING'}, {'name': 'destinationhostname', 'type': 'STRING'}, {'name': 'dbottip', 'type': 'STRING'}, {'name': 'deploymentrate', 'type': 'INTEGER'}, {'name': 'productstatus', 'type': 'STRING'}, {'name': 'cortexsalesrep', 'type': 'STRING'}, {'name': 'incidentsunderinvestigation', 'type': 'INTEGER'}, {'name': 'customerterritory', 'type': 'STRING'}, {'name': 'customerusecasesinproduction', 'type': 'STRING'}, {'name': 'customersinceq', 'type': 'STRING'}, {'name': 'destinationport', 'type': 'STRING'}, {'name': 'deniedcustomerreachoutreason', 'type': 'STRING'}, {'name': 'customermovedtops', 'type': 'BOOLEAN'}, {'name': 'followupdate', 'type': 'TIMESTAMP'}, {'name': 'capsuleregion', 'type': 'STRING'}, {'name': 'sfdccasereopen', 'type': 'BOOLEAN'}, {'mode': 'REPEATED', 'name': 'handoverqatable', 'type': 'STRING'}, {'name': 'nclbfollowupdate', 'type': 'TIMESTAMP'}, {'name': 'mobiledevicemodel', 'type': 'STRING'}, {'name': 'instancetype', 'type': 'STRING'}, {'name': 'averagealertsinincidentstotal', 'type': 'FLOAT'}, {'name': 'customeroverview', 'type': 'STRING'}, {'name': 'customerstatusdescription', 'type': 'STRING'}, {'fields': [{'name': 'columnheader1', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'customerusecasesnew', 'type': 'RECORD'}, {'name': 'customertheater', 'type': 'STRING'}, {'name': 'serialcount', 'type': 'INTEGER'}, {'name': 'lastxdrhealthcheck', 'type': 'TIMESTAMP'}, {'name': 'entarea', 'type': 'STRING'}, {'name': 'dashboardlink', 'type': 'STRING'}, {'name': 'fttv', 'type': 'INTEGER'}, {'name': 'iotuserpassword', 'type': 'STRING'}, {'name': 'saleshandovercompletiondate', 'type': 'TIMESTAMP'}, {'name': 'eventid', 'type': 'STRING'}, {'name': 'salescalldate', 'type': 'TIMESTAMP'}, {'name': 'csteamassignmentnotifydate', 'type': 'TIMESTAMP'}, {'name': 'prodmagniferdaystoactivation', 'type': 'STRING'}, {'name': 'category', 'type': 'STRING'}, {'name': 'prodmagnifersku', 'type': 'STRING'}, {'name': 'prodmagniferexpirationdate', 'type': 'STRING'}, {'name': 'customerstatusexplanation', 'type': 'STRING'}, {'name': 'xdrepplicensecount', 'type': 'INTEGER'}, {'name': 'nclbpartnermanaged', 'type': 'BOOLEAN'}, {'name': 'devicelocalip', 'type': 'STRING'}, {'name': 'ingainsightpilot', 'type': 'BOOLEAN'}, {'name': 'howmanyusecasesdoyouhaveinproduction', 'type': 'STRING'}, {'name': 'customerstatusdate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'customeremailhistory', 'type': 'STRING'}, {'name': 'nclbcustomerresponsestatus', 'type': 'STRING'}, {'name': 'csframeworkphase', 'type': 'STRING'}, {'name': 'lasteventdate', 'type': 'TIMESTAMP'}, {'name': 'roles', 'type': 'STRING'}, {'name': 'customersince', 'type': 'TIMESTAMP'}, {'name': 'customerstatus', 'type': 'STRING'}, {'name': 'riskiqsupportcontact', 'type': 'STRING'}, {'name': '_3rdpartyvendor', 'type': 'STRING'}, {'name': 'lastcasestatus', 'type': 'STRING'}, {'name': 'customerstateselect', 'type': 'STRING'}, {'name': 'nclbcsassistancenotes', 'type': 'STRING'}, {'name': 'businessgoal', 'type': 'STRING'}, {'name': 'customersalesrep', 'type': 'STRING'}, {'name': 'xdrpreventcustomersince', 'type': 'TIMESTAMP'}, {'name': 'question3knowledgetransfe', 'type': 'STRING'}, {'name': 'dbotclosed', 'type': 'TIMESTAMP'}, {'name': 'appchannelname', 'type': 'STRING'}, {'name': 'backupcsa', 'type': 'STRING'}, {'name': 'customerresponsestatus', 'type': 'STRING'}, {'name': 'customerrenewalamount', 'type': 'INTEGER'}, {'name': 'healthcheckreleasenotelink', 'type': 'STRING'}, {'name': 'customerrenewalamt', 'type': 'FLOAT'}, {'name': 'entitlementenddate', 'type': 'TIMESTAMP'}, {'name': 'ngfw81', 'type': 'BOOLEAN'}, {'name': 'customerregion', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'healthcheckriskyindexedfields', 'type': 'STRING'}, {'name': 'autofocusapikey', 'type': 'STRING'}, {'name': 'customerreachoutnotes', 'type': 'STRING'}, {'name': 'customerreachoutapproved', 'type': 'BOOLEAN'}, {'name': 'id', 'type': 'INTEGER'}, {'name': 'customersuccessarchitectname', 'type': 'STRING'}, {'fields': [{'name': 'version', 'type': 'FLOAT'}, {'name': 'newest_eol', 'type': 'FLOAT'}, {'name': 'mailsent', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'contacts', 'type': 'STRING'}, {'name': 'lcaasid', 'type': 'INTEGER'}, {'name': 'date', 'type': 'TIMESTAMP'}, {'name': 'action', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrboteol', 'type': 'RECORD'}, {'name': 'customerproductiongolivedate', 'type': 'TIMESTAMP'}, {'name': 'saleshandoverstatus', 'type': 'STRING'}, {'name': 'edrcustomerwitheppagents', 'type': 'BOOLEAN'}, {'name': 'customersuccessmanagername', 'type': 'STRING'}, {'name': 'question2staffskill', 'type': 'STRING'}, {'name': 'customerpooled', 'type': 'BOOLEAN'}, {'name': 'rawjson', 'type': 'STRING'}, {'name': 'adoptionrate', 'type': 'INTEGER'}, {'name': 'tcv', 'type': 'INTEGER'}, {'name': 'iselastic', 'type': 'BOOLEAN'}, {'fields': [{'name': 'feedback', 'type': 'STRING'}, {'name': 'reason', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'email', 'type': 'STRING'}, {'name': 'correctcontact', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrbotunsubscribedusers', 'type': 'RECORD'}, {'name': 'accounttier', 'type': 'STRING'}, {'name': 'epcoldretentionlicense', 'type': 'INTEGER'}, {'name': 'cortexpstype', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'urlsslverification', 'type': 'STRING'}, {'name': 'reference', 'type': 'STRING'}, {'name': 'customerinproduction', 'type': 'BOOLEAN'}, {'name': 'internalemail1senddate', 'type': 'TIMESTAMP'}, {'fields': [{'name': 'result', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'product', 'type': 'STRING'}, {'name': 'test', 'type': 'STRING'}, {'name': 'details', 'type': 'STRING'}, {'name': 'recommendation', 'type': 'STRING'}, {'name': 'subject', 'type': 'STRING'}, {'name': 'healthchecktopic', 'type': 'STRING'}, {'name': 'description', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'xdrhealthcheck', 'type': 'RECORD'}, {'fields': [{'name': 'columnheader6', 'type': 'STRING'}, {'name': 'columnheader5', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'sendgridactivity', 'type': 'RECORD'}, {'name': 'customeradditionalcontacts', 'type': 'STRING'}, {'name': 'csmcadence', 'type': 'STRING'}, {'name': 'customermaincscontactname', 'type': 'STRING'}, {'name': 'instanceid', 'type': 'STRING'}, {'name': 'customercontactemail', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdrexceptions', 'type': 'RECORD'}, {'name': 'customerintegrations', 'type': 'STRING'}, {'name': 'novalicensenfr', 'type': 'STRING'}, {'name': 'iotaddon', 'type': 'STRING'}, {'name': 'internalemail2senddate', 'type': 'TIMESTAMP'}, {'name': 'ejframeworkphase', 'type': 'STRING'}, {'name': 'iotlicenseexpiration', 'type': 'STRING'}, {'name': 'adminpassword', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'sortvalues', 'type': 'STRING'}, {'name': 'downloadservertoken', 'type': 'STRING'}, {'name': 'playbookoutcome', 'type': 'STRING'}, {'name': 'novatest', 'type': 'STRING'}, {'name': 'customermsppartnername', 'type': 'STRING'}, {'name': 'xdrbackendversion', 'type': 'STRING'}, {'name': 'howmanyanalystsareworkingonthesystem', 'type': 'STRING'}, {'name': 'coresalesengineer', 'type': 'STRING'}, {'name': 'datacollectionformcompleteddate', 'type': 'STRING'}, {'name': 'xdragentanalytics', 'type': 'STRING'}, {'name': 'customerrenewaldate', 'type': 'TIMESTAMP'}, {'name': 'customeremails', 'type': 'STRING'}, {'name': 'migrationcomplete', 'type': 'BOOLEAN'}, {'name': 'vulcansn', 'type': 'STRING'}, {'fields': [{'name': 'totalconnections', 'type': 'INTEGER'}, {'name': 'lcaas_id', 'type': 'INTEGER'}, {'name': 'deviceid', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'brokervmagentproxyconnections', 'type': 'RECORD'}, {'name': 'xdreolagentcountin90days', 'type': 'INTEGER'}, {'name': 'customeradopted', 'type': 'BOOLEAN'}, {'name': 'healthcheckreleasedate', 'type': 'STRING'}, {'name': 'customercityselect', 'type': 'STRING'}, {'name': 'customercountryselect', 'type': 'STRING'}, {'name': 'cortexxdrid', 'type': 'STRING'}, {'name': 'implementationassistancenotes', 'type': 'STRING'}, {'name': 'xdrcloudagentcount', 'type': 'INTEGER'}, {'name': 'customincidentdatastructure', 'type': 'STRING'}, {'name': 'fttvrange', 'type': 'STRING'}, {'name': 'escalatedaccount', 'type': 'BOOLEAN'}, {'name': 'dbotcreated', 'type': 'TIMESTAMP'}, {'name': 'producttype', 'type': 'STRING'}, {'name': 'xdrtbusagemonthly', 'type': 'FLOAT'}, {'name': 'alertid', 'type': 'STRING'}, {'fields': [{'name': 'superuser', 'type': 'BOOLEAN'}, {'name': 'phone', 'type': 'STRING'}, {'name': 'name', 'type': 'STRING'}, {'name': 'position', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'email', 'type': 'STRING'}, {'name': 'cconsupport', 'type': 'BOOLEAN'}, {'name': 'default', 'type': 'BOOLEAN'}], 'mode': 'REPEATED', 'name': 'customercontacts', 'type': 'RECORD'}, {'name': 'accountcsmsdl', 'type': 'STRING'}, {'fields': [{'name': 'value', 'type': 'STRING'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdroscount', 'type': 'RECORD'}, {'name': 'maxincidentsperassignee', 'type': 'INTEGER'}, {'name': 'md5', 'type': 'STRING'}, {'fields': [{'mode': 'REPEATED', 'name': 'contacts', 'type': 'STRING'}, {'name': 'date', 'type': 'TIMESTAMP'}, {'name': 'action', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'emailcommunication', 'type': 'RECORD'}, {'name': 'sha1', 'type': 'STRING'}, {'name': 'coresalesrep', 'type': 'STRING'}, {'name': 'corerep', 'type': 'STRING'}, {'name': 'customersuccessmanager', 'type': 'STRING'}, {'name': 'prodlaketenantid', 'type': 'STRING'}, {'name': 'salesoutreachnotes', 'type': 'STRING'}, {'name': 'nclbontrackreason', 'type': 'STRING'}, {'fields': [{'name': 'correctcontact', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'products', 'type': 'STRING'}, {'name': 'feedback', 'type': 'STRING'}, {'name': 'reason', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'email', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'cseventsunsubscribedusers', 'type': 'RECORD'}, {'name': 'xsoarbotreportfailed', 'type': 'STRING'}, {'name': 'consumptionupdated', 'type': 'TIMESTAMP'}, {'name': 'csttv', 'type': 'INTEGER'}, {'name': 'customerselectedcategory', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'cspcontacts', 'type': 'STRING'}, {'name': 'tenantname', 'type': 'STRING'}, {'name': 'investigationstage', 'type': 'STRING'}, {'name': 'ptwave', 'type': 'STRING'}, {'name': 'hoursspenttotal', 'type': 'FLOAT'}, {'name': 'devicehash', 'type': 'STRING'}, {'name': 'caller', 'type': 'STRING'}, {'name': 'networksecurityids', 'type': 'STRING'}, {'name': 'selectami', 'type': 'STRING'}, {'name': 'cvescore', 'type': 'STRING'}, {'name': 'xdrlegacylicenseallocated', 'type': 'BOOLEAN'}, {'name': 'csmmigrationrecommendation', 'type': 'STRING'}, {'name': 'csacadence', 'type': 'STRING'}, {'name': 'implementstage', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'lowlevelcategoriesevents', 'type': 'STRING'}, {'name': 'xdredragentcount', 'type': 'INTEGER'}, {'name': 'businesssecurityobjectivespanwengagement', 'type': 'STRING'}, {'name': 'customeremailsenddate', 'type': 'TIMESTAMP'}, {'name': 'cspremiumamount', 'type': 'FLOAT'}, {'mode': 'REPEATED', 'name': 'gpsgaccounts', 'type': 'STRING'}, {'name': 'ccemails', 'type': 'STRING'}, {'name': 'cortexadoptionscore', 'type': 'FLOAT'}, {'name': 'ptwavelaunchdate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'cspid', 'type': 'STRING'}, {'name': 'averagealertsinincidentsopen', 'type': 'FLOAT'}, {'name': 'sfdcusgcase', 'type': 'BOOLEAN'}, {'name': 'attendedxdrofficehours', 'type': 'STRING'}, {'name': 'attendedxdr1manykom', 'type': 'BOOLEAN'}, {'name': 'producttier', 'type': 'STRING'}, {'name': 'numberofterabytespurchased', 'type': 'INTEGER'}, {'name': 'hoursspentadoption', 'type': 'INTEGER'}, {'name': 'salesoutreachcompletiondate', 'type': 'TIMESTAMP'}, {'name': 'entregion', 'type': 'STRING'}, {'name': 'saleshandoverdate', 'type': 'TIMESTAMP'}, {'name': 'pstypetraps', 'type': 'BOOLEAN'}, {'name': 'psassistanceneeded', 'type': 'STRING'}, {'name': 'onholdreason', 'type': 'STRING'}, {'name': 'aretheredifferentgroupstiersrolesintheteam', 'type': 'STRING'}, {'name': 'includeinweeklycustomerhighlight', 'type': 'BOOLEAN'}, {'fields': [{'name': 'columnheader1', 'type': 'STRING'}, {'name': 'teamrole', 'type': 'STRING'}, {'name': 'columnheader3', 'type': 'STRING'}, {'name': 'columnheader2', 'type': 'STRING'}, {'name': 'name', 'type': 'STRING'}, {'name': 'title', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'email', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'accountteam', 'type': 'RECORD'}, {'name': 'servicenowrecordid', 'type': 'STRING'}, {'name': 'sfdcclosereason', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'milestoneactivityreports', 'type': 'STRING'}, {'name': 'templateid', 'type': 'STRING'}, {'name': 'customerincidentid', 'type': 'INTEGER'}, {'name': 'xdrpreventrenewalamount', 'type': 'FLOAT'}, {'name': 'arr', 'type': 'STRING'}, {'name': '_3rdpartyfwvendor', 'type': 'STRING'}, {'name': 'operationstype', 'type': 'STRING'}, {'name': 'customertier', 'type': 'STRING'}, {'name': 'conductinitialhealthcheck', 'type': 'BOOLEAN'}, {'name': 'consumptionagents', 'type': 'STRING'}, {'name': 'rawphase', 'type': 'STRING'}, {'name': 'cvereferencelinks', 'type': 'STRING'}, {'name': 'assigneduser', 'type': 'STRING'}, {'name': 'customerstatuscolor', 'type': 'STRING'}, {'name': 'type', 'type': 'STRING'}, {'fields': [{'name': 'total', 'type': 'INTEGER'}, {'name': 'mitretactic', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'incidentsmitretactic', 'type': 'RECORD'}, {'name': 'customerlocation', 'type': 'STRING'}, {'name': 'sfdcopportunitycloseddate', 'type': 'STRING'}, {'name': 'sfdccasereopenreason', 'type': 'STRING'}, {'name': 'doyouworkwithanmdrmsspforthreathunting', 'type': 'STRING'}, {'name': 'csecadence', 'type': 'STRING'}, {'name': 'cslasthealthcheckdate', 'type': 'TIMESTAMP'}, {'name': 'accountterritorydistrict', 'type': 'STRING'}, {'name': 'salescustomeraccounttype', 'type': 'STRING'}, {'name': 'hasthecustomerhassignedupforcommunityaccessedition', 'type': 'STRING'}, {'fields': [{'name': 'eol', 'type': 'TIMESTAMP'}, {'name': 'value', 'type': 'FLOAT'}, {'name': 'total', 'type': 'INTEGER'}], 'mode': 'REPEATED', 'name': 'xdragentmajorversioncount', 'type': 'RECORD'}, {'fields': [{'name': 'usecasename', 'type': 'STRING'}, {'name': 'proddate', 'type': 'TIMESTAMP'}, {'mode': 'REPEATED', 'name': 'comments', 'type': 'STRING'}, {'name': 'usecasestatus', 'type': 'STRING'}, {'name': 'startdate', 'type': 'TIMESTAMP'}], 'mode': 'REPEATED', 'name': 'customerusecases', 'type': 'RECORD'}, {'name': 'env', 'type': 'STRING'}, {'name': 'accountterritoryregion', 'type': 'STRING'}, {'name': 'salescallscheduled', 'type': 'BOOLEAN'}, {'name': 'affectedhost', 'type': 'STRING'}, {'name': 'onholdreasoncategory', 'type': 'STRING'}, {'name': 'numberofhosts', 'type': 'STRING'}, {'fields': [{'name': 'delaynotes', 'type': 'STRING'}, {'name': 'delayreason', 'type': 'STRING'}, {'name': 'completiondate', 'type': 'TIMESTAMP'}, {'name': 'phase', 'type': 'STRING'}, {'name': 'done', 'type': 'BOOLEAN'}, {'name': 'id', 'type': 'INTEGER'}, {'name': 'duedate', 'type': 'DATE'}, {'name': 'description', 'type': 'STRING'}, {'name': 'milestone', 'type': 'STRING'}, {'mode': 'REPEATED', 'name': 'tiers', 'type': 'STRING'}], 'mode': 'REPEATED', 'name': 'journeymilestones', 'type': 'RECORD'}, {'name': 'xdranalyticsalertssum', 'type': 'INTEGER'}, {'name': 'emailcc', 'type': 'STRING'}, {'name': 'devicemodel', 'type': 'STRING'}, {'name': 'modified', 'type': 'TIMESTAMP'}, {'name': 'appmessage', 'type': 'STRING'}, {'name': 'mdrpartner', 'type': 'STRING'}, {'name': 'doyouhaveathreathuntingfunction', 'type': 'STRING'}, {'name': 'created', 'type': 'TIMESTAMP'}, {'name': 'currentstatusdescriptionifapplicable', 'type': 'STRING'}, {'name': 'severity', 'type': 'INTEGER'}, {'name': 'partnermanaged', 'type': 'BOOLEAN'}, {'name': 'psengaged', 'type': 'BOOLEAN'}, {'name': 'productiondelayreasonnotes', 'type': 'STRING'}, {'name': 'cstechmigrationrecommendation', 'type': 'STRING'}, {'name': 'pstyperesidentengineer', 'type': 'BOOLEAN'}]
    print(l1)
    fields_schema = []
    fields_dict = {}
    string_schema = []

    schema_map_1 = {"INTEGER": IntegerType(), "STRING": StringType(), "TIMESTAMP": StringType()
        , "BOOLEAN": BooleanType(), 'FLOAT': LongType(), 'BYTES': StringType()
        , 'DATE': DateType()
                    }

    for field in l1:
        name = field.get("name",'')
        data_type = field.get("type",'')
        fields = field.get("fields", [])
        mode = field.get("mode", 'NULLABLE')
        value_name = ''
        if mode == 'REPEATED' and not fields:
            #print("12")
            # fields_schema.append(StructField(name, ArrayType(schema_map_1[data_type]), True))
            # fields_schema.append(data_type_conversion(name,schema_map_1[data_type]))
            value_name =(StructField(name, ArrayType(schema_map_1[data_type]), True))
            fields_schema.append(value_name)
            string_schema.append(StructField(name, ArrayType(StringType()), True))
        elif data_type != 'RECORD' and not fields:
            # fields_schema.append(data_type_conversion(name,data_type))
            value_name = (StructField(name, schema_map_1[data_type], True))
            fields_schema.append(value_name)
            string_schema.append(StructField(name, StringType(), True))
        elif data_type == 'RECORD':
            sub_col_list = []
            sub_col_list_string =[]
            for sub_col in fields:
                # print(sub_col)
                sub_col_list.append(StructField(sub_col['name'], schema_map_1[sub_col['type']], True))
                sub_col_list_string.append(StructField(sub_col['name'],StringType() , True))
                # print(sub_col_list)
                value_name = (StructField(name, (ArrayType(StructType(list(sub_col_list)), True)), True))
            fields_schema.append(value_name)
            string_schema.append((StructField(name, (ArrayType(StructType(list(sub_col_list_string)), True)), True)))
        fields_dict[name] = value_name
    print(fields_dict)
    print(fields_schema)
    print(string_schema)

def convert_list_to_string():
    list_of_tables="Below are the tables not refreshed: \n"
    l1=[['2023-09-19', 'xsoar_adoption_rate`'], ['2023-09-19', 'xdr_adoption_rate`'],
     ['2023-09-19', 'xdr_deployment_rate`']]
    for i in l1:
        list_of_tables += f"{i[1]} : {i[0]} \n"
    print(list_of_tables)

def tuple_analysis():
    #Tuples are immutable and used for Data Integrity (Can not chnage the values)
    #Tuple items are ordered, unchangeable, and allow duplicate values.
    #When we say that tuples are ordered, it means that the items have a defined order, and that order will not change.
    #Tuples are unchangeable, meaning that we cannot change, add or remove items after the tuple has been created.

    t1=(1,2,3,7,6,5,9)
    print(t1[0])
    print(t1.index(3))
    print(sorted(t1))
    print(t1)

def sets_analysis():
    #sets are unorderes colletion of unique elements
    print("-------------------sets analysis--------------------")
    s = {1,2,3}
    print(s)
    l=[1,1,1,1,1,12,2,2,2,2,8,9,0,0,0,0]
    print(set(l))
    print("-------------------sets analysis--------------------")

if __name__=="__main__":
    list_analysis()
    dict_analysis()
    convert_listof_dict()
    convert_list_to_string()
    tuple_analysis()
    sets_analysis()
